---
title: 2020.11.14æœ¬å‘¨æ€»ç»“
date: 2020-11-14 18:17:40
tags: [æ€»ç»“]
categories: [æ€»ç»“]
description: å•¥éƒ½æœ‰
---

æœ¬å‘¨é‡åˆ°äº†äº”ä¸ªé—®é¢˜ï¼Œä¸‰ä¸ªreactçš„ï¼Œå‰©ä¸‹çš„æ˜¯ä¸šåŠ¡ä¸Šçš„

#### 1. input changeé—®é¢˜ä¿®å¤
æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†æ˜¯æ‰‹å†™çš„ï¼Œå¯¹äºé€‰æ‹©æ–‡ä»¶çš„å˜åŒ–ä¸€èˆ¬æ˜¯ç›‘å¬input(type="file")çš„changeäº‹ä»¶ï¼Œä½†æ˜¯å½“ä¸¤æ¬¡é€‰æ‹©çš„æ–‡ä»¶çš„ä¸€æ ·çš„æ—¶å€™æ˜¯ä¸ä¼šè§¦å‘changeäº‹ä»¶çš„ã€‚å¦‚ä½•ä¿®å¤å®ƒå‘¢ï¼Ÿå€Ÿç”¨reactä¸­çš„keyï¼Œchangeäº‹ä»¶ä¸­æ”¹å˜inputçš„keyï¼Œä¼šä½¿reacté‡æ–°åˆ›å»ºinputï¼Œä¿è¯æ¯æ¬¡çš„inputçš„éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå°±ä¸ä¼šæœ‰ä¸Šè¿°çš„é—®é¢˜äº†
```js
const Rc = () => {
  const inputKey = useRef(v4())

  const changeFile = () => {
    inputKey.current = v4()
  }

  return (
    <input type="file" key={inputKey.current} onChange={changeFile} />
  )
}
```

#### 2. forä¸­å¾ªç¯æ”¹å˜state
ç°åœ¨æ‰€æœ‰çš„å¼€å‘å·²ç»å…¨éƒ¨æ‹¥æŠ±hookäº†ï¼Œé™¤éhookæä¸å®šã€‚ç›®å‰çš„åœºæ™¯æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¾ªç¯æ”¹å˜stateçš„å€¼ï¼Œåœ¨classä¸­ä½¿ç”¨å‰ä¸€å®šè¦å…ˆå–å€¼ï¼Œä½†æ˜¯hookçš„è¯åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œç›´æ¥ä¸å–å°±ç›´æ¥ç”¨äº†ï¼Œå¯¼è‡´å€¼åªä¼šæ”¹å˜ä¸€æ¬¡ï¼Œå› ä¸ºåœ¨å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œstateçš„å€¼å°±è¡Œäº†ã€‚æƒ³æ¸…æ¥šè¿™ä¸ªï¼Œæˆ‘éœ€è¦å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ä½œä¸ºæ¯æ¬¡å¾ªç¯ä¸­çš„ç´¯ç§¯ã€‚
```js
const Rc = () => {
  const [tab, setTab] = useState(0)
  const handle = () => {
    let newTab = tab

    for (...) {
      newTab = ...
      setTab(newTab)
    }
  }
}
```

#### 3. useEffectå¯¹å¾…å¤šä¸ªeffectä¸åŒçš„æ“ä½œ
é¦–å…ˆéœ€æ±‚ä¸Šæ˜¾ç¤ºè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¤æ‚çš„ç»„ä»¶ï¼Œæ‰€ä»¥è¿˜æ˜¯é€‰æ‹©hookè€Œä¸æ˜¯classæ¥ç»„ç»‡ã€‚ä½†æ˜¯é‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œä¸¤ä¸ªfetchæ–¹æ³•ä¼šè¢«ä¸‰ä¸ªå€¼å½±å“ï¼Œä¸¤ä¸ªpropsï¼Œä¸€ä¸ªstateï¼Œæœ‰çš„å€¼æ”¹å˜ä¼šå¯¼è‡´ä¸¤ä¸ªfetchï¼Œæœ‰çš„å€¼ä¼šå¯¼è‡´ä¸€ä¸ªfetchã€‚åœ¨classä¸­ä½ å¯ä»¥é€šè¿‡prevå’Œcurrentè¿›ä¸€æ­¥åŒºåˆ«åˆ°åº•æ˜¯å“ªä¸ªå€¼æ”¹å˜ï¼Œä½†æ˜¯hookæ˜¯æ²¡æœ‰è¿™ä¸ªè®°å¿†åŠŸèƒ½çš„ï¼Œä¸€ä¸ªç»„ä»¶éƒ½å†™å®Œäº†æˆ‘ä¹Ÿä¸æƒ³æ”¹æˆclassäº†ï¼Œæœ€åçš„è§£å†³æ˜¯å®šä¹‰ä¸€ä¸ªrefæ¥ä¿å­˜ä¹‹å‰çš„prev
```js
const Rc = () => {
  const prevTab = useRef(default)

  useEffect(() => {
    if (prevTab !== tab) {
      fetch1()
    }
    fetch2()
  }, [tab, value2, value3])
}

```


#### 4. ä¸šåŠ¡ä¸­äºŒçº§å…³ç³»å˜æˆäº†ä¸‰çº§
è¿™ä¸ªåœ¨éœ€æ±‚ä¸­åº”è¯¥æ˜¯breakchangeï¼ŒæŒ‰ç…§æ­£å¸¸çš„è¿­ä»£èŠ‚å¥ï¼Œå¿…é¡»æ•°æ®åº“çš„è¡¨ç»“æ„å¿…é¡»è¦å…¼å®¹ä¹‹å‰çš„è€æ•°æ®ã€‚å¦‚æœå½“ä½œæ–°éœ€æ±‚è¿›è¡Œè¡¨ç»“æ„è®¾è®¡éå¸¸ç®€å•ã€‚å’Œåç«¯åŒå­¦äº¤æµåï¼Œè€ƒè™‘åˆ°ç°åº¦åˆ°ä¸Šçº¿ä¸¤å¤©å†…çš„æ•°æ®ï¼Œå°±å¿…é¡»è¦å…¼å®¹ï¼Œæ‰€ä»¥æŠ€æœ¯æ–¹æ¡ˆå’Œä¹‹å‰æ¯”è¾ƒçº¯ç²¹çš„æ¯”æ˜¾å¾—å¤æ‚ã€‚

#### 5. åœ¨åŒ…å«ä¸é‡å¤çš„æ•°å­—æ•°ç»„ä¸­éšæœºå–å‡ºnä¸ªçš„æ•°å­—
å¯¹å¾…è¿™ä¸ªé—®é¢˜ï¼Œæƒ³åˆ°ä¸€ä¸ªæœ€ç®€å•ç²—æš´çš„æ–¹æ³•ï¼Œä½¿ç”¨random + setï¼Œä½¿ç”¨setçš„ä¸å­˜åœ¨é‡å¤å€¼çš„ç‰¹æ€§
```js
const getNnumber = (list, n) => {
  const { length } = list
  const nums = new Set()

  while(nums.size < n) {
    const index = Math.ceil(Math.random() * length)
    nums.add(nums[index])
  }

  return nums
}
```
åŒäº‹æä¾›çš„æ–¹æ³•æ˜¯[è¿™ä¸ª](https://blog.csdn.net/qq_28476865/article/details/102606852)

ä¸è¿‡åœ¨stackoverflowä¸Šåˆæ‰¾åˆ°äº†å¦ä¸€ä¸ªæ–¹æ³•ï¼šå¯ä»¥å…ˆæ··æ´—æ•°ç»„ï¼Œç„¶åå–å‰nä¸ª[how-to-get-random-elements-from-an-array](https://stackoverflow.com/questions/7158654/how-to-get-random-elements-from-an-array/7158691)ï¼Œè¿™ä¸ªæ–¹æ³•çœ‹èµ·æ¥æŒºå¥½ğŸ‘

```js
numbers.sort( function() { return 0.5 - Math.random() } );
```

